<!DOCTYPE html>
<html style="display: block; height: 4154px">

  <body>
    <div style="display: block; width: 1000px; margin-left: auto; margin-right: auto;" id="plots">

      <canvas id="canvas_correct"></canvas>
      <canvas id="canvas_others"></canvas>
      <canvas id="canvas_detected"></canvas>
      <canvas id="canvas_falsepositive"></canvas>
      <canvas id="canvas_smart_cables_connection"></canvas>
      <canvas id="canvas_smart_cables_connection_per_appliance"></canvas>

      <canvas id="canvas_correctness_by_meter_washing_machine"></canvas>
      <canvas id="canvas_correctness_by_meter_dishwasher"></canvas>
      <canvas id="canvas_correctness_by_meter_fridge"></canvas>
      <canvas id="canvas_correctness_by_meter_tumble_dryer"></canvas>
    </div>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script type="text/javascript">

      const colors = createColors();

      var kpiCsv = ',2020-04-29,2020-05-06,2020-05-13,2020-05-20,2020-05-27\nperct_days_with_others_less_20,77,64,85,86,85\nDishwasher_prct_detected,45,64,69,60,74\nDishwasher_prct_false_positive,2,21,16,7,4\nDishwasher_prct_correct,30,44,56,61,77\nTumbleDryer_prct_detected,49,44,45,45,44\nTumbleDryer_false_positive,4,4,5,6,7\nTumbleDryer_prct_correct,45,41,60,62,65\nWashingMachine_prct_detected,80,78,81,82,78\nWashingMachine_false_positive,13,12,16,17,18\nWashingMachine_prct_correct,86,80,84,85,88\nSingleFridge_prct_correct,45,60,62,80,83';
      var kpiData = readCVS(kpiCsv);
      createKPIsCanvas(kpiData);

      var correctnessCsv = 'appliance,meter_id,num_days,num_correct_days,prct_correct_days\nDishwasher,237e2cd9-f7c3-4e1e-9607-8545d755ada7,32,24,75\nDishwasher,bffa1b89-7328-413a-886f-4712ec8f3c12,48,28,58.3333333333333\nDishwasher,f4a64c6a-33c9-4ca5-9579-a36add57a9e7,59,51,86.4406779661017\nDishwasher,fef3cbef-13ec-4b06-b2cd-f9c2cf0c09bb,61,51,83.6065573770492\nSingleFridge,44739798-89d0-45b8-8ba7-7946facfa9c9,72,68,94.4444444444444\nSingleFridge,4ec49423-22df-4fe2-bd80-07af918c1bac,2,2,100\nSingleFridge,56d6412c-b5c7-41fa-8e21-9adc83e93f7e,76,46,60.5263157894737\nSingleFridge,78f9e22e-bd12-4c0d-b724-045d6ed5e4c5,70,52,74.2857142857143\nSingleFridge,b3e92fd2-a486-43ac-8ab5-f99fa808fe86,88,76,86.3636363636364\nSingleFridge,f4a64c6a-33c9-4ca5-9579-a36add57a9e7,60,60,100\nTumbleDryer,237e2cd9-f7c3-4e1e-9607-8545d755ada7,55,26,47.2727272727273\nTumbleDryer,85757c17-f87f-4308-a899-1a3777819af4,47,46,97.8723404255319\nTumbleDryer,b3e92fd2-a486-43ac-8ab5-f99fa808fe86,44,8,18.1818181818182\nTumbleDryer,fef3cbef-13ec-4b06-b2cd-f9c2cf0c09bb,98,79,80.6122448979592\nWashingMachine,237e2cd9-f7c3-4e1e-9607-8545d755ada7,40,36,90\nWashingMachine,4ec49423-22df-4fe2-bd80-07af918c1bac,1,1,100\nWashingMachine,56d6412c-b5c7-41fa-8e21-9adc83e93f7e,52,48,92.3076923076923\nWashingMachine,78f9e22e-bd12-4c0d-b724-045d6ed5e4c5,16,11,68.75\nWashingMachine,c72f03e4-25aa-4044-b7b2-c58b090ba182,84,72,85.7142857142857\nWashingMachine,da77074f-43ff-44b7-8efa-180bcf5d6a53,23,19,82.6086956521739\nWashingMachine,f4a64c6a-33c9-4ca5-9579-a36add57a9e7,59,57,96.6101694915254\nWashingMachine,fda4646b-4f9c-4e51-b779-ac916c0b687d,3,2,66.6666666666667';
      var correctnessData = readCVS(correctnessCsv);
      createCorrectnessCanvas(correctnessData);

      updateIframeHeight();




/*---------------- KIPs overviews ----------------*/

      function printCorrectCanvas(labels, dataArray, object)
      {
        var data =  createDataApplianceKPI(labels, dataArray, object);

        CreateLineChart('canvas_correct', 'Correct Energy', data);
      }

      function printOthersCanvas(labels, dataArray, object)
      {
        var data =  createDataApplianceKPI(labels, dataArray, object);

        CreateLineChart('canvas_others', 'Percentage of days with Others <20%', data);
      }

      function printDetectedCanvas(labels, dataArray, object)
      {
        var data =  createDataApplianceKPI(labels, dataArray, object);

        CreateLineChart('canvas_detected', 'Detected Cycles', data);
      }

      function printFalsePositiveCanvas(labels, dataArray, object)
      {
        var data =  createDataApplianceKPI(labels, dataArray, object);

        CreateLineChart('canvas_falsepositive', 'False Positive Cycles', data);
      }

      function printSmartCablesConnection()
      {
        var ctx = document.getElementById('canvas_smart_cables_connection');

        var data =  {
          labels: ['08/04/2020', '15/04/2020', '22/04/2020', '29/04/2020', '06/05/2020', '13/05/2020'],
          datasets: [
            {
              label: 'Connection',
              fill: false,
              pointHoverRadius: 6,
              borderWidth: 2,
              lineTension: 0,
              selected: false,
              color: blue,
              borderColor: blue.toString(),
              backgroundColor: blue.toString(),
              data: [43, 66, 93, 91, 94, 94]
            }
          ]
        }

        var options = {
          title: {
              display: true,
              text: 'Smart Cables Connection',
              fontSize: 30,
              fontStyle: 'bold',
              fontColor: '#000',
              lineHeight: 3
          },
          legend: {
            position: 'right',
            align: 'start',
            onClick: function (event, legendItem) {
              onClickLegendItem(event, legendItem, myLineChart)
            },
            onHover: function (event, legendItem) {
              onHoverLegendItem(event, legendItem, myLineChart)
            },
            onLeave: function (event, legendItem) {
              onLeaveLegendItem(event, legendItem, myLineChart)
            }
          },
          scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true 
                }
            }]
          },
          hover: {
						mode: 'point',
						intersect: false,
					}
        };
        
        var myLineChart = new Chart(ctx, {
          type: 'line',
          data: data,
          options: options
        });
      }

      function printSmartCablesPerApplianceConnection()
      {
        var ctx = document.getElementById('canvas_smart_cables_connection_per_appliance');

        var data =  {
          labels: ['08/04/2020', '15/04/2020', '22/04/2020', '29/04/2020', '06/05/2020', '13/05/2020'],
          datasets: [
            {
              label: 'Dishwasher',
              fill: false,
              pointHoverRadius: 6,
              borderWidth: 2,
              lineTension: 0,
              selected: false,
              color: blue,
              borderColor: blue.toString(),
              backgroundColor: blue.toString(),
              data: [9, 14, 14, 19, 19, 21]
            },
            {
              label: 'Tumble Dryer',
              fill: false,
              pointHoverRadius: 6,
              borderWidth: 2,
              lineTension: 0,
              selected: false,
              color: yellow,
              borderColor: yellow.toString(),
              backgroundColor: yellow.toString(),
              data: [17, 28, 27, 27, 28, 28]
            },
            {
              label: 'Washing Machine',
              fill: false,
              pointHoverRadius: 6,
              borderWidth: 2,
              lineTension: 0,
              selected: false,
              color: green,
              borderColor: green.toString(),
              backgroundColor: green.toString(),
              data: [12, 25, 33, 43, 44, 60]
            },
            {
              label: 'Fridge',
              fill: false,
              pointHoverRadius: 6,
              borderWidth: 2,
              lineTension: 0,
              selected: false,
              color: purple,
              borderColor: purple.toString(),
              backgroundColor: purple.toString(),
              data: [13, 25, 34, 46, 49, 49]
            }
          ]
        }

        var options = {
          title: {
              display: true,
              text: 'Smart Cables Connection Per Appliance',
              fontSize: 30,
              fontStyle: 'bold',
              fontColor: '#000',
              lineHeight: 3
          },
          legend: {
            position: 'right',
            align: 'start',
            onClick: function (event, legendItem) {
              onClickLegendItem(event, legendItem, myLineChart)
            },
            onHover: function (event, legendItem) {
              onHoverLegendItem(event, legendItem, myLineChart)
            },
            onLeave: function (event, legendItem) {
              onLeaveLegendItem(event, legendItem, myLineChart)
            }
          },
          scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
          },
          hover: {
						mode: 'point',
						intersect: false,
					}
        };
        
        var myLineChart = new Chart(ctx, {
          type: 'line',
          data: data,
          options: options
        });
      }





/*---------------- Correctness By Meter Per Appliance ----------------*/

      function printCorrectnessByMeterWashingMachine(arrayData)
      {
        if(arrayData == null)
        {
          return;
        }

        var data = createDataApplianceCorrectness(arrayData);

        CreateBarChart('canvas_correctness_by_meter_washing_machine', 'Washing Machine', data );
      }

      function printCorrectnessByMeterDishwasher(arrayData)
      {
        if(arrayData == null)
        {
          return;
        }

        var data = createDataApplianceCorrectness(arrayData);

        CreateBarChart('canvas_correctness_by_meter_dishwasher', 'Dishwasher', data );
      }

      function printCorrectnessByMeterFridge(arrayData)
      {
        if(arrayData == null)
        {
          return;
        }

        var data = createDataApplianceCorrectness(arrayData);

        CreateBarChart('canvas_correctness_by_meter_fridge', 'Fridge', data);
      }

      function printCorrectnessByMeterTumbleDryer(arrayData)
      {
        if(arrayData == null)
        {
          return;
        }

        var data = createDataApplianceCorrectness(arrayData);

        CreateBarChart('canvas_correctness_by_meter_tumble_dryer', 'Tumble Dryer', data);
      }




/*---------------- Create Charts ----------------*/

      function CreateLineChart(elementId, title, data)
      {
        var ctx = document.getElementById(elementId).getContext('2d');

        var options = {
          title: {
              display: true,
              text: title,
              fontSize: 30,
              fontStyle: 'bold',
              fontColor: '#000',
              lineHeight: 3
          },
          legend: {
            position: 'right',
            align: 'start',
            labels: {
              fontStyle: 'normal',
              strokeStyle: 'rgb(0, 255, 0)'
            },
            onClick: function (event, legendItem) {
              onClickLegendItem(event, legendItem, myLineChart)
            },
            onHover: function (event, legendItem) {
              onHoverLegendItem(event, legendItem, myLineChart)
            },
            onLeave: function (event, legendItem) {
              onLeaveLegendItem(event, legendItem, myLineChart)
            }
          },
          scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true,
                    max: 100
                }
            }]
          },
          hover: {
						mode: 'point',
						intersect: false,
					}
        };
        
        var myLineChart = new Chart(ctx, {
          type: 'line',
          data: data,
          options: options
        });

      }

      function CreateBarChart(elementId, title, data)
      {
        var ctx = document.getElementById(elementId);

        var options = {
          title: {
              display: true,
              text: title,
              fontSize: 30,
              fontStyle: 'bold',
              fontColor: '#000',
              lineHeight: 3
          },
          legend: {
            position: 'right',
            align: 'start',
            labels: {
              //fontStyle: 'bolder'
              fontWeight: 500
            },
            onClick: function (event, legendItem) {
              onClickLegendItem(event, legendItem, myBarChart)
            },
            onHover: function (event, legendItem) {
              onHoverLegendItem(event, legendItem, myBarChart)
            },
            onLeave: function (event, legendItem) {
              onLeaveLegendItem(event, legendItem, myBarChart)
            }
          },
          scales: {
            yAxes: [
              {
                ticks: {
                    beginAtZero: true,
                    max: 100
                },
                display: true,
                position: 'left',
                id: 'y-axis-prctg-correct-days-objective'
              },
              {
                ticks: {
                    beginAtZero: true,
                    max: 110
                },
                display: true,
                position: 'right',
                id: 'y-axis-number-days'
              }
            ]
          },
          hover: {
						mode: 'point',
						intersect: false,
					}
        };
        
        var myBarChart = new Chart(ctx, {
          type: 'bar',
          data: data,
          options: options
        });
      }




/*---------------- Create DataSet Array ----------------*/

      function CreateDataSetArrayForLineCharts(options)
      {
        var dataSets = [];

        for (let i = 0; i < options.length; i++) {

          var dataSet = {
            pointHoverRadius: 6,
            borderWidth: 2,
            lineTension: 0,
            selected: false,
            label: options[i][0],
            fill: options[i][1],
            color: options[i][2],
            borderColor: options[i][2].toString(),
            colorBackground: options[i][3],
            backgroundColor: options[i][3] ? options[i][3].toString() : null,
            data: options[i][4]
          };

          dataSets.push(dataSet);
        }

        return dataSets;
      }

      function CreateDataSetArrayForBarCharts(options)
      {
        var dataSets = [];

        for (let i = 0; i < options.length; i++) {

          var dataSet = {
            borderWidth: 2,
            lineTension: 0,
            pointHoverRadius: 6,
            selected: false,
            label: options[i][0],
            type: options[i][1],
            yAxisID: options[i][2],

            color: options[i][3],
            borderColor: options[i][1] == 'line' ? options[i][3].toString() : null,

            colorBackground: options[i][1] == 'line' ? options[i][4] : null,
            backgroundColor: options[i][4].toString(),

            data: options[i][5]
          };

          dataSets.push(dataSet);
        }

        return dataSets;
      }





/*---------------- Update iframe height ----------------*/

      function updateIframeHeight() {

        var plots = document.getElementById('plots');
        var plotsStyle = getComputedStyle(plots);

        console.log('Plot Height: ' + plotsStyle.height);

        /*
        var iFrameID = window.parent.document.getElementById('iframe_plots');

        if(iFrameID) {

          console.log('iframe');

          console.log('IFrame Height: ' + iFrameID.height);

          iFrameID.height = "";
          iFrameID.height = plotsStyle.height;
        }*/
      }





/*---------------- Improvements on Charts behaviours ----------------*/

      function onHoverLegendItem(event, legendItem, chart)
      {
        var index = legendItem.datasetIndex;
        var dataSet = chart.data.datasets[index];
        var ds = chart.getDatasetMeta(index);

        if(dataSet.barPercentage != null)
        {
          dataSet.barPercentage = 1;
        }
        else if(dataSet.borderWidth != null)
        {
          dataSet.borderWidth = 6;
        }

        chart.update();
      }

      function onLeaveLegendItem(event, legendItem, chart)
      {
        var index = legendItem.datasetIndex;
        var dataSet = chart.data.datasets[index];

        if(!dataSet.selected)
        {
          if(dataSet.barPercentage != null)
          {
            dataSet.barPercentage = 0.8;
          }
          else if(dataSet.borderWidth != null)
          {
            dataSet.borderWidth = 2;
          }
        } 

        chart.update();
      }

      function onClickLegendItem(event, legendItem, chart)
      {
        var index = legendItem.datasetIndex;
        var dataSet = chart.getDatasetMeta(index);
        var dataSetSelected = dataSet.controller._config.selected;

        for (let i = 0; i < chart.data.datasets.length; i++) {

          var colorAlpha = 1;
          var colorBackgroundAlpha = 0.12;
          var borderWidth = 2;
          var selected = false;

          var color = chart.data.datasets[i].color;
          var colorBackground = chart.data.datasets[i].colorBackground;

          if(dataSetSelected)
          {
            colorAlpha = 1;
            colorBackgroundAlpha = 0.12;
            borderWidth = 2;
            selected = false;

            //HideTooltipsOfSelectedDataSet(chart, dataSet);
          }
          else
          {
            if(index == i)
            {
              colorAlpha = 1;
              colorBackgroundAlpha = 0.12;
              borderWidth = 6;
              selected = true;

              //ShowTooltipsOfSelectedDataSet(chart, dataSet);
            } 
            else
            {
              colorAlpha = 0.2;
              colorBackgroundAlpha = 0.05;
              borderWidth = 2;
              selected = false;
            }
          }

          chart.data.datasets[i].selected = selected;
          chart.data.datasets[i].borderWidth = borderWidth;

          color.alpha = colorAlpha;
          chart.data.datasets[i].color = color;
          chart.data.datasets[i].borderColor = color.toString();

          if(colorBackground == null)
          {
            chart.data.datasets[i].backgroundColor = color.toString();
          }
          else
          {
            colorBackground.alpha = colorBackgroundAlpha;
            chart.data.datasets[i].colorBackground = colorBackground;
            chart.data.datasets[i].backgroundColor = colorBackground.toString();
          }
        }

        chart.update();
      }

      function ShowTooltipsOfSelectedDataSet(chart, dataSet)
      {
        if(chart.tooltip._active == undefined)
          chart.tooltip._active = [];

        for (let i = 0; i < dataSet.data.length; i++) {

          console.log(dataSet.data[i]);


          chart.tooltip._active.push(dataSet.data[i]);
        }

        chart.tooltip.update(true);
      }

      function HideTooltipsOfSelectedDataSet(chart, dataSet)
      {
        var activeElements = chart.tooltip._active;

        if(chart.tooltip._active == undefined || chart.tooltip._active.length == 0)
        {
          return;
        }

        var requestedElem = chart.getDatasetMeta(datasetIndex).data[pointIndex];
        for(var i = 0; i < activeElements.length; i++) {
            if(requestedElem._index == activeElements[i]._index)  {
                activeElements.splice(i, 1);
                break;
            }
        }
        chart.tooltip._active = activeElements;
        chart.tooltip.update(true);
        chart.draw();
      }





/*---------------- Colors ----------------*/
      function Color(red, green, blue, alpha) {
        this.red = red;
        this.green = green;
        this.blue = blue; 
        this.alpha = alpha;
        this.toString = () => `rgb(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`;
      }

      function createColors()
      {
        var blue = new Color(66, 133, 244, 1);
        var yellow = new Color(244, 180, 0, 1);
        var green = new Color(15, 157, 88, 1);
        var purple = new Color(171, 71, 188, 1);
        var red = new Color(219, 68, 55, 1);
        var lightRed = new Color(219, 68, 55, 0.12);


        return [blue, yellow, green, purple, red, lightRed];
      }

      function createObjective(objectiveValue, labels)
      {
        // Label[0],            Fill[1],    Color/BorderColor[2],   BackgroundColor[3],   Data[4]
        //['Objetive',          true,       red,                    lightRed,             [80, 80, 80, 80, 80] ]

        var fill = true;
        if(objectiveValue <= 10)
        {
          fill = 'end';
        }

        var data = [];

        for (let i = 0; i < labels.length; i++)
        {
          data.push(objectiveValue);
        }

        return ['Objective', fill, colors[4], colors[5], data ];
      }





/*---------------- CVS ----------------*/
      function readCVS(allText) {
        var allTextLines = allText.split(/\r\n|\n/);

        var lines = [];

        for (var i=0; i<allTextLines.length; i++) {
            var data = allTextLines[i].split(',');

            lines.push(data);
        }

        return lines;
    }

      function createKPIsCanvas(kpiData)
      {
        var prctCorrectString = "_prct_correct";
        var prctDetected = "_prct_detected";
        var prctFalsePositive = "_false_positive";
        var prctOther = "perct_days_with_others_less_20";

        if(kpiData == null)
        {
          return;
        }

        var labels = [];

        for (let i = 0; i < kpiData[0].length; i++)
        {
          if(kpiData[0][i] != null && kpiData[0][i] != "")
          {
            labels.push(kpiData[0][i]);
          }
        }

        if(labels == null)
        {
          return;
        }

        var correctData = [];
        var detectedData = [];
        var falsePositiveData = [];
        var othersData = [];

        for (let i = 1; i < kpiData.length; i++) 
        {
          if(kpiData[i][0].includes(prctCorrectString))
          {
            var correctValues = [];

            var label = kpiData[i][0].replace(prctCorrectString, "");

            for (let j = 1; j < kpiData[i].length; j++)
            {
              correctValues.push(kpiData[i][j]);
            }

            correctData.push([label, correctValues]);
          }
          else if(kpiData[i][0].includes(prctDetected))
          {
            var label = kpiData[i][0].replace(prctDetected, "");

            var detectedValues = [];
            for (let j = 1; j < kpiData[i].length; j++)
            {
              detectedValues.push(kpiData[i][j]);
            }

            var detected = [label, detectedValues];

            detectedData.push(detected);
          }
          else if(kpiData[i][0].includes(prctFalsePositive))
          {
            var label = kpiData[i][0].replace(prctFalsePositive, "");

            var falsePositiveValues = [];

            for (let j = 1; j < kpiData[i].length; j++)
            {
              falsePositiveValues.push(kpiData[i][j]);
            }

            falsePositiveData.push([label, falsePositiveValues]);
          }
          else if(kpiData[i][0].includes(prctOther))
          {
            var others = [];
            var othersValues = [];

            for (let j = 1; j < kpiData[i].length; j++)
            {
              othersValues.push(kpiData[i][j]);
            }

            other = ["Others", othersValues];

            othersData.push(other);
          }
        }

        var objective80 = createObjective(80, labels);
        var objective10 = createObjective(10, labels);

        printCorrectCanvas(labels, correctData, objective80);
        printOthersCanvas(labels, othersData, objective80);
        printDetectedCanvas(labels, detectedData, objective80);
        printFalsePositiveCanvas(labels, falsePositiveData, objective10);

        //printSmartCablesConnection();
        //printSmartCablesPerApplianceConnection();
      }

      function createCorrectnessCanvas(correctnessData)
      {
        if(kpiData == null)
        {
          return;
        }

        console.log(correctnessData);

        var data = {}; 

        for (let i = 1; i < correctnessData.length; i++)
        {

          if(data[correctnessData[i][0]] == null)
          {
            data[correctnessData[i][0]] = [];
          }

          data[correctnessData[i][0]].push([
              getSensorId4Chars(correctnessData[i][1]),
              Number(correctnessData[i][2]), 
              Number(correctnessData[i][4])
            ]
          );
         
        }

        printCorrectnessByMeterWashingMachine(data["WashingMachine"]);
        printCorrectnessByMeterDishwasher(data["Dishwasher"]);
        printCorrectnessByMeterFridge(data["SingleFridge"]);
        printCorrectnessByMeterTumbleDryer(data["TumbleDryer"]);

      }




/*---------------- AssistFunctions ----------------*/
      function createDataApplianceKPI(labels, dataArray, object)
      {
        // Label[0],            Fill[1],    Color/BorderColor[2],   BackgroundColor[3],   Data[4]
        var dataAppliances = [];

        for (let i = 0; i < dataArray.length; i++) {
          var appliance = [dataArray[i][0], false, colors[i], null, dataArray[i][1]];

          dataAppliances.push(appliance);
        }

        dataAppliances.push(object);

        var data =  {
          labels: labels,
          datasets: CreateDataSetArrayForLineCharts(dataAppliances)
        }

        return data;
      }

      function createDataApplianceCorrectness(dataArray)
      {
        dataArray = shortCorrectessByPrctCorrectDays(dataArray);

        var labels = [];
        var numberOfDays = [];
        var perctCorrectDays = [];
        var objective = [];

        for (let i = 0; i < dataArray.length; i++)
        {
          labels.push(dataArray[i][0]);
          numberOfDays.push(dataArray[i][1]);
          perctCorrectDays.push(dataArray[i][2]);

          objective.push(80);
        }

        // Label[0],                      Type[1],      yAxisID[2],                               BorderColor[3],   BackgroundColor[4],   Data[5]
        var data = [
          ['Percentage Correct Days',     'bar',        'y-axis-prctg-correct-days-objective',    colors[0],        colors[0],            perctCorrectDays ],
          ['Number of Days',              'bar',        'y-axis-number-days',                     colors[1],        colors[1],            numberOfDays     ],
          ['Objetive',                    'line',       'y-axis-prctg-correct-days-objective',    colors[4],        colors[5],            objective        ],
        ];

        var data =  {
          labels: labels,
          datasets: CreateDataSetArrayForBarCharts(data)
        }

        return data;
      }

      function getSensorId4Chars(sensorId)
      {
        var fourCharSensorId = sensorId.slice(0, 4);


        return fourCharSensorId;
      }

      function shortCorrectessByPrctCorrectDays(dataArray)
      {
        var shortedArray = dataArray.sort(function(a, b) { return a[2] - b[2]; });

        return shortedArray;
      }


    </script>

  </body>

</html>
